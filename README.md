# üõí TANYARAT E-commerce Platform

‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ú‡πà‡∏≤‡∏ô **LINE LIFF** ‡πÅ‡∏•‡∏∞ **LINE Bot** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à Tanyarat

[![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)](https://nodejs.org/)
[![MongoDB](https://img.shields.io/badge/MongoDB-6+-green.svg)](https://mongodb.com/)
[![LINE LIFF](https://img.shields.io/badge/LINE-LIFF%20v2-00B900.svg)](https://developers.line.biz/en/docs/liff/)

---

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å](#-‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å)
- [‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ](#-‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ)
- [‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á](#-‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á)
- [‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE LIFF (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)](#-‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤-line-liff-‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)
- [‡∏Å‡∏≤‡∏£ Deploy Production](#-‡∏Å‡∏≤‡∏£-deploy-production)
- [API Endpoints](#-api-endpoints)
- [‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö](#-‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö)
- [Troubleshooting](#-troubleshooting)

---

## ‚ú® ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å

### üîê ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å LINE LIFF
- **Auto-Login** - ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å username/password
- **LINE Profile Integration** - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å LINE ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- **Seamless UX** - ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô LINE App ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á

### ü§ñ LINE Bot (Messaging API)
- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
- ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á
- ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- Rich Menu / Flex Message

### ‚≠ê ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∞‡∏™‡∏°‡πÅ‡∏ï‡πâ‡∏°
- 1 ‡πÅ‡∏ï‡πâ‡∏°‡∏ï‡πà‡∏≠ 100 ‡∏ö‡∏≤‡∏ó
- ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏ï‡πâ‡∏°
- ‡πÅ‡∏•‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î

### üõçÔ∏è E-commerce
- ‡πÅ‡∏Ñ‡∏ï‡∏ï‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
- ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

```
momx/
‚îú‚îÄ‚îÄ backend/                    # Backend API (Node.js/Express)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lineAuthController.js    # LINE authentication
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ orderController.js       # Order + LINE notifications
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ User.js                  # User model + LINE profile
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lineRoutes.js            # LINE auth routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ webhookRoutes.js         # LINE Bot webhook
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lineBotService.js        # LINE Messaging API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.js
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ .env                         # Environment variables
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ liff.html                    # ‡∏´‡∏ô‡πâ‡∏≤ LIFF ‡∏´‡∏•‡∏±‡∏Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ assets/js/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ liff-app.js              # LIFF JavaScript
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ LINE_SETUP_GUIDE.md                  # ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md
```

---

## üöÄ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### Prerequisites

- Node.js 18+
- MongoDB 6+
- LINE Developers Account
- Domain ‡∏û‡∏£‡πâ‡∏≠‡∏° SSL (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Production)

### 1. Clone Repository

```bash
git clone https://github.com/treventator/momx.git
cd momx
```

### 2. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies

```bash
# Backend
cd backend
npm install

# Frontend
cd ../frontend
npm install
```

### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `backend/config/.env`:

```env
# ===========================================
# Server Configuration
# ===========================================
NODE_ENV=development
PORT=4455

# ===========================================
# Database
# ===========================================
MONGODB_URI=mongodb://localhost:27017/tanyarat_shop

# ===========================================
# JWT
# ===========================================
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters

# ===========================================
# Frontend URL (for CORS)
# ===========================================
FRONTEND_URL=http://localhost:3000

# ===========================================
# LINE Configuration (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!)
# ===========================================

# LINE Login Channel ID (‡∏à‡∏≤‡∏Å LINE Developers Console)
LINE_CHANNEL_ID=your_line_login_channel_id

# LINE Login Channel Secret
LINE_CHANNEL_SECRET=your_line_login_channel_secret

# LIFF ID (‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å LINE Login Channel > LIFF tab)
LIFF_ID=your_liff_id

# LINE Messaging API Channel Access Token
# (‡∏à‡∏≤‡∏Å Messaging API Channel ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏¢‡∏Å)
LINE_CHANNEL_ACCESS_TOKEN=your_very_long_channel_access_token

# ===========================================
# Optional: Redis (for caching)
# ===========================================
REDIS_HOST=localhost
REDIS_PORT=6379
CACHE_ENABLED=false
```

### 4. ‡∏£‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (Development)

```bash
# Terminal 1 - Backend
cd backend
npm run dev

# Terminal 2 - Frontend
cd frontend
npm run dev
```

---

## üîß ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE LIFF (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Login Channel

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [LINE Developers Console](https://developers.line.biz/console/)
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á **Provider** ‡πÉ‡∏´‡∏°‡πà (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
3. ‡∏Å‡∏î **Create a new channel** ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **LINE Login**
4. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:

| Field | Value |
|-------|-------|
| Channel name | `TANYARAT Member` |
| Channel description | `‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏£‡πâ‡∏≤‡∏ô TANYARAT` |
| App types | ‚òëÔ∏è Web app |
| Email | ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì |

5. ‡∏Å‡∏î **Create**

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏î‡∏∂‡∏á Credentials

‡πÑ‡∏õ‡∏ó‡∏µ‡πà tab **Basic settings**:

```
Channel ID     ‚Üí ‡πÉ‡∏™‡πà‡πÉ‡∏ô .env ‡πÄ‡∏õ‡πá‡∏ô LINE_CHANNEL_ID
Channel secret ‚Üí ‡πÉ‡∏™‡πà‡πÉ‡∏ô .env ‡πÄ‡∏õ‡πá‡∏ô LINE_CHANNEL_SECRET
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏™‡∏£‡πâ‡∏≤‡∏á LIFF App

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà tab **LIFF**
2. ‡∏Å‡∏î **Add**
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:

| Field | Value |
|-------|-------|
| LIFF app name | `TANYARAT Member` |
| Size | `Full` |
| Endpoint URL | `https://yourdomain.com/liff.html` |
| Scopes | ‚òëÔ∏è profile, ‚òëÔ∏è openid, ‚òëÔ∏è email |
| Bot link feature | `On (Aggressive)` |

4. ‡∏Å‡∏î **Add**
5. Copy **LIFF ID** ‚Üí ‡πÉ‡∏™‡πà‡πÉ‡∏ô:
   - `.env` ‡πÄ‡∏õ‡πá‡∏ô `LIFF_ID`
   - `frontend/public/assets/js/liff-app.js` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 7

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏™‡∏£‡πâ‡∏≤‡∏á Messaging API Channel (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Bot)

1. ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Provider
2. ‡∏Å‡∏î **Create a new channel** ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Messaging API**
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:

| Field | Value |
|-------|-------|
| Channel name | `TANYARAT Bot` |
| Channel description | `‡∏ö‡∏≠‡∏ó‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡πâ‡∏≤‡∏ô TANYARAT` |
| Category | Shopping |

4. ‡∏Å‡∏î **Create**

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook

‡πÑ‡∏õ‡∏ó‡∏µ‡πà tab **Messaging API**:

1. **Webhook URL**: `https://yourdomain.com/api/webhooks/line`
2. **Use webhook**: ‚òëÔ∏è ‡πÄ‡∏õ‡∏¥‡∏î
3. ‡∏Å‡∏î **Verify** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö
4. ‡∏Å‡∏î **Issue** ‡∏ó‡∏µ‡πà Channel access token ‚Üí Copy ‡πÉ‡∏™‡πà `.env`

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 6: ‡∏õ‡∏¥‡∏î Auto-reply

1. ‡∏Å‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ **LINE Official Account Manager**
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥** ‚Üí ‡∏õ‡∏¥‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö** ‚Üí ‡∏õ‡∏¥‡∏î

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 7: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LIFF ‡∏Å‡∏±‡∏ö Bot

1. ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ LINE Login Channel
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **LIFF** ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å LIFF app
3. ‡∏ó‡∏µ‡πà **Linked OA** ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Bot ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á
4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

---

## üåê ‡∏Å‡∏≤‡∏£ Deploy Production

### Option 1: VPS (Recommended)

#### 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Server

```bash
# Ubuntu 22.04
sudo apt update && sudo apt upgrade -y

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Node.js 18
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MongoDB
wget -qO - https://www.mongodb.org/static/pgp/server-6.0.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/6.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list
sudo apt update && sudo apt install -y mongodb-org
sudo systemctl start mongod && sudo systemctl enable mongod

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Nginx
sudo apt install -y nginx

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Certbot (SSL)
sudo apt install -y certbot python3-certbot-nginx
```

#### 2. Clone ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

```bash
cd /var/www
sudo git clone https://github.com/treventator/momx.git
cd momx

# Backend
cd backend
sudo npm install --production
sudo cp config/.env.example config/.env
sudo nano config/.env  # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ

# Frontend
cd ../frontend
sudo npm install --production
```

#### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ PM2

```bash
sudo npm install -g pm2

# ‡∏£‡∏±‡∏ô Backend
cd /var/www/momx/backend
pm2 start src/index.js --name "tanyarat-api"
pm2 save
pm2 startup
```

#### 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Nginx

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `/etc/nginx/sites-available/tanyarat`:

```nginx
# Frontend
server {
    listen 80;
    server_name yourdomain.com www.yourdomain.com;

    root /var/www/momx/frontend/public;
    index index.html;

    # LIFF route
    location /liff.html {
        try_files $uri $uri/ =404;
    }

    # Static files
    location / {
        try_files $uri $uri/ /index.html;
    }

    # API Proxy
    location /api {
        proxy_pass http://localhost:4455;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

```bash
sudo ln -s /etc/nginx/sites-available/tanyarat /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

#### 5. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á SSL (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç - LIFF ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ HTTPS)

```bash
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com
```

#### 6. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó LINE Settings

‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ LINE Developers Console:

1. **LIFF Endpoint URL**: `https://yourdomain.com/liff.html`
2. **Webhook URL**: `https://yourdomain.com/api/webhooks/line`
3. ‡∏Å‡∏î **Verify** ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

---

### Option 2: Docker Compose

#### 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á `.env` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Production

```env
NODE_ENV=production
MONGODB_URI=mongodb://mongo:27017/tanyarat_shop
# ... (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô)
```

#### 2. ‡∏£‡∏±‡∏ô Docker Compose

```bash
docker-compose -f docker-compose.yml up -d --build
```

#### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Reverse Proxy (Nginx/Traefik)

‡πÉ‡∏ä‡πâ Nginx ‡∏´‡∏£‡∏∑‡∏≠ Traefik ‡πÄ‡∏õ‡πá‡∏ô reverse proxy ‡∏û‡∏£‡πâ‡∏≠‡∏° SSL

---

### Option 3: Cloud Platform

#### Vercel + MongoDB Atlas

**Frontend (Vercel):**
```bash
cd frontend
vercel deploy --prod
```

**Backend (Railway/Render):**
1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Project ‡πÉ‡∏ô Railway/Render
2. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GitHub repo
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables
4. Deploy

---

## üì° API Endpoints

### LINE Authentication

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/line/auth` | Login/Register ‡∏ú‡πà‡∏≤‡∏ô LINE LIFF |
| POST | `/api/line/verify` | Verify ID Token |
| GET | `/api/line/me` | ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå (‡∏ï‡πâ‡∏≠‡∏á auth) |
| PUT | `/api/line/profile` | ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå (‡∏ï‡πâ‡∏≠‡∏á auth) |

### LINE Bot Webhook

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/webhooks/line` | ‡∏£‡∏±‡∏ö events ‡∏à‡∏≤‡∏Å LINE |

### Products

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/shop/products` | ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î |
| GET | `/api/shop/products/:id` | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ |
| GET | `/api/shop/products/featured` | ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ |

### Orders

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/shop/orders` | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ |
| GET | `/api/shop/orders` | ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ |
| GET | `/api/shop/orders/:id` | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ |

### Cart

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/shop/cart` | ‡∏î‡∏π‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ |
| POST | `/api/shop/cart` | ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ |
| PUT | `/api/shop/cart/:id` | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô |
| DELETE | `/api/shop/cart/:id` | ‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ |

---

## üß™ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö LIFF (Browser)

```
https://liff.line.me/YOUR_LIFF_ID
```

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö LIFF (LINE App)

1. ‡πÄ‡∏õ‡∏¥‡∏î LINE ‚Üí ‡πÅ‡∏ä‡∏ó‡∏Å‡∏±‡∏ö Bot
2. ‡∏û‡∏¥‡∏°‡∏û‡πå `‡∏ö‡∏±‡∏ç‡∏ä‡∏µ` ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô Rich Menu
3. ‡∏´‡∏ô‡πâ‡∏≤ LIFF ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô LINE App

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Webhook

```bash
curl -X POST https://yourdomain.com/api/webhooks/line \
  -H "Content-Type: application/json" \
  -H "X-Line-Signature: test" \
  -d '{"events":[]}'
```

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö LINE Auth API

```bash
# ‡πÉ‡∏ä‡πâ Access Token ‡∏à‡∏≤‡∏Å LIFF
curl -X POST https://yourdomain.com/api/line/auth \
  -H "Content-Type: application/json" \
  -d '{"accessToken": "YOUR_LINE_ACCESS_TOKEN"}'
```

---

## üîç Troubleshooting

### ‚ùå LIFF ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** LIFF ID ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠ Endpoint URL ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà HTTPS

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö LIFF ID ‡πÉ‡∏ô `liff-app.js`
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Endpoint URL ‡πÄ‡∏õ‡πá‡∏ô HTTPS
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ domain ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô

### ‚ùå Webhook ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** Signature verification failed

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `LINE_CHANNEL_SECRET` ‡πÉ‡∏ô `.env`
2. ‡πÉ‡∏ä‡πâ Channel Secret ‡∏à‡∏≤‡∏Å **Messaging API Channel** (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà LINE Login)
3. ‡∏Å‡∏î Verify ‡πÉ‡∏ô LINE Developers Console

### ‚ùå ‡πÑ‡∏î‡πâ Error "Invalid LINE channel"

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** Channel ID ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡πÉ‡∏ä‡πâ Channel ID ‡∏à‡∏≤‡∏Å **LINE Login Channel**
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `.env` ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

### ‚ùå Bot ‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** Channel Access Token ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡πÑ‡∏õ Messaging API Channel
2. ‡∏Å‡∏î **Issue** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á token ‡πÉ‡∏´‡∏°‡πà
3. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó `.env` ‡πÅ‡∏•‡∏∞ restart server

### ‚ùå ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ add Bot ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ LIFF ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö Bot ‡πÅ‡∏•‡πâ‡∏ß (Linked OA)
2. ‡∏ï‡∏±‡πâ‡∏á Bot link feature ‡πÄ‡∏õ‡πá‡∏ô `On (Aggressive)`

---

## üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- [LINE LIFF Documentation](https://developers.line.biz/en/docs/liff/)
- [LINE Messaging API](https://developers.line.biz/en/docs/messaging-api/)
- [LINE Login](https://developers.line.biz/en/docs/line-login/)

---

## üìÑ License

¬© 2024 TANYARAT. All Rights Reserved.

---

## üë• Contributors

- **Teemmer** - Developer

---

## üÜò Support

‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á [Issue](https://github.com/treventator/momx/issues) ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:
- LINE: @tanyarat
- Email: support@tanyarat.com
